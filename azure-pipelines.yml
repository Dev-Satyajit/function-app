trigger:
  - feature*
  - develop
  - stage
  - integration
  - qa
  - main
  - hotfix*
  - drop*

pool: Windows Agent

steps:
  - task: FuncToolsInstaller@0
    inputs:
      version: 'latest'

  - task: Maven@3
    displayName: 2 || build code
    inputs:
      mavenPomFile: pom.xml
      mavenOptions: -Xmx3072m
      javaHomeOption: JDKVersion
      jdkVersionOption: '1.17'
      jdkArchitectureOption: x64
      publishJUnitResults: true
      testResultsFiles: '**/surefire-reports/TEST-*.xml'
      goals: clean package

  - task: CopyFiles@2
    displayName: 5 || copy all artifacts
    inputs:
      SourceFolder: $(system.defaultworkingdirectory)
      Contents: pom.xml
      TargetFolder: $(Build.ArtifactStagingDirectory)
      OverWrite: true


  - task: PublishBuildArtifacts@1
    displayName: 6 || publish artifacts
    # condition: ne(variables['Build.SourceBranchName'], 'feature/*')
    inputs:
      PathtoPublish: $(Build.ArtifactStagingDirectory)